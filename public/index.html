<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>AP Elite</title>
  
  
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;400;600;800&display=swap" rel="stylesheet">
  
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Manrope', 'sans-serif'] },
          colors: {
            gold: '#D4AF37',
            dark: '#050505',
            panel: '#111111'
          }
        }
      }
    }
  </script>

  <style>
    body { background-color: #050505; color: #e5e5e5; }
    
    
    .fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    
    .elite-input {
      background: transparent;
      border: none;
      border-bottom: 1px solid #333;
      color: white;
      text-align: center;
      transition: all 0.5s ease;
      font-weight: 200;
      letter-spacing: 1px;
    }
    .elite-input:focus {
      outline: none;
      border-bottom: 1px solid #D4AF37;
      letter-spacing: 2px;
    }

    
    .elite-btn {
      background: #1a1a1a;
      border: 1px solid #333;
      color: #888;
      transition: all 0.4s ease;
      letter-spacing: 2px;
      text-transform: uppercase;
      font-size: 0.75rem;
    }
    .elite-btn:hover {
      background: #D4AF37;
      border-color: #D4AF37;
      color: black;
      transform: translateY(-2px);
    }

    
    .player-row { border-bottom: 1px solid #1a1a1a; transition: 0.3s; }
    .player-row:hover { background: #0f0f0f; }

    
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: #050505; }
    ::-webkit-scrollbar-thumb { background: #333; }

    .hidden { display: none !important; }
  </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-6 overflow-hidden relative">

  
  <div class="absolute w-[800px] h-[800px] border border-white/5 rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none opacity-20"></div>
  <div class="absolute w-[600px] h-[600px] border border-white/5 rounded-full top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none opacity-30"></div>

  <div class="w-full max-w-2xl relative z-10">

    
    <div id="screen-login" class="text-center fade-in">
      <div class="mb-12">
        <h1 class="text-5xl font-extralight tracking-[0.2em] text-white mb-2">AP<span class="font-bold text-gold">PRO</span></h1>
        <p class="text-xs text-neutral-500 uppercase tracking-widest">Minimalist Bilgi YarÄ±ÅŸmasÄ±</p>
      </div>

      <div class="space-y-8 max-w-xs mx-auto">
        <input id="username" type="text" placeholder="Ä°SÄ°M GÄ°RÄ°NÄ°Z" class="elite-input w-full py-4 text-xl placeholder-neutral-700">
        
        <button onclick="joinGame()" class="elite-btn w-full py-4 rounded-sm font-semibold">
          YarÄ±ÅŸmaya BaÅŸla
        </button>
        
        <div class="pt-8">
          <button onclick="joinAdmin()" class="text-[10px] text-neutral-700 hover:text-neutral-400 transition tracking-widest uppercase">
            YÃ¶netici Paneli
          </button>
        </div>
      </div>
    </div>

      <div id="screen-wait" class="hidden text-center fade-in">
      <div class="w-16 h-16 border-t-2 border-r-2 border-gold rounded-full animate-spin mx-auto mb-8 opacity-80"></div>
      <h2 class="text-2xl font-light tracking-wide mb-2">BEKLENÄ°YOR</h2>
      <p class="text-neutral-500 text-sm mb-8">YÃ¶netici onayÄ± bekleniyor...</p>
      
      <div class="inline-flex items-center gap-2 px-4 py-2 border border-white/10 rounded-full">
        <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
        <span class="text-xs text-neutral-400">BAÄžLI: <span id="player-count" class="text-white">0</span></span>
      </div>
    </div>

    
    <div id="screen-admin" class="hidden w-full h-[80vh] flex flex-col fade-in bg-panel border border-white/5 rounded-xl overflow-hidden p-8">
      <div class="flex justify-between items-end mb-8 border-b border-white/10 pb-4">
        <div>
          <h2 class="text-xl font-light tracking-widest text-gold">KONTROL PANELÄ°</h2>
          <p class="text-xs text-neutral-500 mt-1">CANLI YAYIN AKIÅžI</p>
        </div>
        <button id="start-btn" onclick="startGame()" class="elite-btn px-6 py-3 border-gold/50 text-gold hover:bg-gold hover:text-black">
          BAÅžLAT
        </button>
      </div>

      
      <div class="grid grid-cols-12 gap-4 text-[10px] text-neutral-600 uppercase tracking-widest mb-4 px-4">
        <div class="col-span-1 text-center">#</div>
        <div class="col-span-5">Ä°sim</div>
        <div class="col-span-3 text-center">Durum</div>
        <div class="col-span-3 text-right">Ä°lerleme</div>
      </div>

      
      <div id="admin-list" class="flex-1 overflow-y-auto space-y-1">
        
      </div>
    </div>

    
    <div id="screen-game" class="hidden w-full fade-in">
      
      <div class="flex justify-between items-center mb-12 border-b border-white/10 pb-4">
        <span id="q-counter" class="text-xs font-bold text-gold tracking-widest">01 / 07</span>
        <div class="w-32 h-[1px] bg-neutral-800">
          <div id="progress-bar" class="h-full bg-gold transition-all duration-700" style="width: 0%"></div>
        </div>
      </div>

      
      <div id="question-text" class="text-2xl md:text-3xl font-light leading-relaxed mb-12 text-center min-h-[120px] flex items-center justify-center">
        YÃ¼kleniyor...
      </div>

      
      <div id="options-area" class="grid grid-cols-1 gap-4 max-w-lg mx-auto">
        
      </div>
    </div>

    
    <div id="screen-eliminated" class="hidden text-center fade-in">
      <h1 class="text-6xl font-thin text-neutral-800 mb-4 tracking-widest">ELENDÄ°N</h1>
      <div class="w-12 h-[1px] bg-red-900 mx-auto mb-6"></div>
      <p class="text-neutral-500 text-sm tracking-wide">YarÄ±ÅŸma devam ediyor, lÃ¼tfen bekleyiniz.</p>
    </div>

    
    <div id="screen-result" class="hidden text-center fade-in">
      <div id="result-icon" class="text-4xl mb-6 text-gold animate-bounce"></div>
      <h2 id="winner-title" class="text-3xl font-light tracking-[0.3em] mb-4 text-white uppercase"></h2>
      <p id="winner-msg" class="text-neutral-400 text-sm font-light mb-12 tracking-wide"></p>
      
      <button onclick="location.reload()" class="elite-btn px-12 py-4">
        Sistemi Yenile
      </button>
    </div>

  </div>

<script>
  const socket = io();
  let myRole = "player";
  let totalQuestions = 7;

  
  const questions = [
    { q: "Emziren kadÄ±nlarda Ã¶nerilmeyen yÃ¶ntem?", options: ["KOK", "RÄ°A", "Kondom", "POP"] },
    { q: "DoÄŸum sonrasÄ± hormonal yÃ¶ntem ne zaman baÅŸlanabilir?", options: ["Hemen", "6 hafta sonra", "1 yÄ±l sonra", "Asla"] },
    { q: "GenÃ§lerde CYBE iÃ§in en Ã¶nemli korunma yÃ¶ntemi?", options: ["RÄ°A", "Kondom", "Ligasyon", "Ä°mplant"] },
    { q: "Nullipar nedir?", options: ["DoÄŸum yapmamÄ±ÅŸ", "Ä°kiz doÄŸurmuÅŸ", "Menopozda", "Erkek partner"] },
    { q: "Acil kontrasepsiyon en etkilisi?", options: ["KOK", "BakÄ±rlÄ± RÄ°A", "DoÄŸal", "Takvim yÃ¶ntemi"] },
    { q: "Menopoz ortalama kaÃ§ yaÅŸ?", options: ["35", "42", "50", "58"] },
    { q: "AP Projesi baÅŸarÄ±yla tamamlandÄ± mÄ±?", options: ["HayÄ±r", "Belki", "EVET!", "SanmÄ±yorum"] }
  ];

  function joinGame() {
    const name = document.getElementById("username").value;
    if(!name) return;
    myRole = "player";
    socket.emit("joinGame", name);
    showScreen("screen-wait");
  }

  function joinAdmin() {
    myRole = "admin";
    socket.emit("joinAsAdmin");
    showScreen("screen-admin");
  }

  function startGame() {
    socket.emit("startGame");
    const btn = document.getElementById("start-btn");
    btn.innerText = "YAYINDA";
    btn.style.borderColor = "#22c55e";
    btn.style.color = "#22c55e";
    btn.disabled = true;
  }

  // --- ADMIN UPDATE ---
  socket.on("adminData", (data) => {
    if(myRole !== "admin") return;
    totalQuestions = data.totalQuestions;
    
    const list = document.getElementById("admin-list");
    list.innerHTML = "";
    
    const sortedPlayers = data.players.sort((a,b) => b.currentQuestionIndex - a.currentQuestionIndex);

    sortedPlayers.forEach((p, index) => {
      let statusDot = `<div class="w-2 h-2 rounded-full bg-green-500 mx-auto shadow-[0_0_10px_rgba(34,197,94,0.5)]"></div>`;
      let opacity = "opacity-100";
      
      if(p.eliminated) {
        statusDot = `<div class="w-2 h-2 rounded-full bg-red-900 mx-auto"></div>`;
        opacity = "opacity-40";
      } else if(p.finished) {
        statusDot = `<div class="w-2 h-2 rounded-full bg-gold mx-auto shadow-[0_0_10px_rgba(212,175,55,0.5)]"></div>`;
      }

      const item = document.createElement("div");
      item.className = `grid grid-cols-12 gap-4 items-center px-4 py-3 player-row ${opacity}`;
      item.innerHTML = `
        <div class="col-span-1 text-center text-xs text-neutral-600">${index + 1}</div>
        <div class="col-span-5 font-light tracking-wide text-sm truncate">${p.name}</div>
        <div class="col-span-3 text-center">${statusDot}</div>
        <div class="col-span-3 text-right text-xs text-neutral-500 font-mono">${p.currentQuestionIndex}/${totalQuestions}</div>
      `;
      list.appendChild(item);
    });
  });

  socket.on("playerCountUpdate", (c) => document.getElementById("player-count").innerText = c);
  
  socket.on("gameStarted", () => {
    if(myRole === "player") {
      showScreen("screen-game");
      loadQuestion(0);
    }
  });

  socket.on("nextQuestion", (idx) => loadQuestion(idx));
  
  socket.on("youAreEliminated", () => {
    showScreen("screen-eliminated");
  });

  socket.on("playerFinishedLate", () => {
    showResult("TAMAMLANDI", "YarÄ±ÅŸmayÄ± bitirdiniz ancak sÄ±ralamaya giremediniz.", "âœ¨");
  });

  socket.on("gameOver", (data) => {
    if(myRole === "admin") {
      
      document.getElementById("start-btn").innerText = "BÄ°TTÄ°";
      document.getElementById("start-btn").style.borderColor = "#ef4444";
      document.getElementById("start-btn").style.color = "#ef4444";
      return;
    }

    if(data.noWinner) {
      showResult("SONUÃ‡ YOK", "Kazanan Ã§Ä±kmadÄ±.", "ðŸ’€");
    } else {
      const amIWinner = (document.getElementById("username").value === data.winnerName);
      if (amIWinner) {
        showResult("ÅžAMPÄ°YON", data.winnerName, "ðŸ‘‘");
        
        var duration = 3 * 1000;
        var end = Date.now() + duration;
        (function frame() {
          confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#D4AF37', '#ffffff'] });
          confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#D4AF37', '#ffffff'] });
          if (Date.now() < end) requestAnimationFrame(frame);
        }());
      } else {
        showResult("KAZANAN", data.winnerName, "ðŸ‘");
      }
    }
  });

  function loadQuestion(index) {
    if(index >= questions.length) return;
    
    
    const percent = ((index) / questions.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
    document.getElementById("q-counter").innerText = (index + 1).toString().padStart(2, '0') + " / " + questions.length.toString().padStart(2, '0');

    
    const qText = document.getElementById("question-text");
    qText.style.opacity = 0;
    setTimeout(() => {
      qText.innerText = questions[index].q;
      qText.style.opacity = 1;
    }, 300);

    const area = document.getElementById("options-area");
    area.innerHTML = "";

    questions[index].options.forEach((opt, i) => {
      const btn = document.createElement("button");
      
      btn.className = "w-full text-left px-6 py-5 border border-white/10 hover:border-gold hover:bg-gold/5 transition-all duration-300 text-sm md:text-base font-light tracking-wide text-neutral-300 hover:text-white group";
      
      btn.innerHTML = `<span class="inline-block w-6 text-neutral-600 group-hover:text-gold mr-2 text-xs font-mono">0${i+1}</span> ${opt}`;
      
      btn.onclick = () => {
        socket.emit("submitAnswer", i);
        area.style.pointerEvents = "none";
        
        btn.classList.add("bg-white", "text-black", "border-white");
        btn.classList.remove("text-neutral-300", "hover:bg-gold/5", "hover:border-gold");
      };
      area.appendChild(btn);
    });
    area.style.pointerEvents = "auto";
  }

  function showResult(title, msg, icon) {
    showScreen("screen-result");
    document.getElementById("winner-title").innerText = title;
    document.getElementById("winner-msg").innerText = msg;
    document.getElementById("result-icon").innerText = icon;
  }

  function showScreen(id) {
    document.querySelectorAll(".max-w-2xl > div").forEach(div => div.classList.add("hidden"));
    const target = document.getElementById(id);
    target.classList.remove("hidden");
    target.classList.add("fade-in");
  }
</script>
</body>
</html>


