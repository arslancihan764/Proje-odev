<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>AP Project</title>
  
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  
  <!-- Font: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&display=swap" rel="stylesheet">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            black: '#000000',
            white: '#FFFFFF',
            offwhite: '#F9FAFB'
          },
          boxShadow: {
            'elite': '0 4px 20px rgba(0,0,0,0.04)',
            'elite-hover': '0 10px 25px rgba(0,0,0,0.08)'
          }
        }
      }
    }
  </script>

  <style>
    body { background-color: #FFFFFF; color: #000000; }
    
    .fade-in { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* Input */
    .elite-input {
      background: #F9FAFB;
      border: 1px solid transparent;
      text-align: center;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    .elite-input:focus {
      background: #FFFFFF;
      border-color: #000000;
      outline: none;
      box-shadow: 0 0 0 2px rgba(0,0,0,0.05);
    }

    /* Button */
    .elite-btn {
      background: #000000;
      color: #FFFFFF;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    .elite-btn:hover {
      background: #333333;
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .elite-btn:active { transform: scale(0.98); }

    .hidden { display: none !important; }
    
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: #fff; }
    ::-webkit-scrollbar-thumb { background: #ddd; border-radius: 4px; }
  </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden font-sans">

  <!-- Arkaplan -->
  <div class="absolute top-[-10%] right-[-10%] w-[600px] h-[600px] bg-gray-50 rounded-full mix-blend-multiply filter blur-3xl opacity-70 pointer-events-none"></div>
  <div class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-gray-50 rounded-full mix-blend-multiply filter blur-3xl opacity-70 pointer-events-none"></div>

  <div class="w-full max-w-xl relative z-10">

    <!-- 1. GÄ°RÄ°Åž -->
    <div id="screen-login" class="text-center fade-in">
      <div class="mb-16">
        <h1 class="text-5xl font-black tracking-tighter text-black mb-1">AP<span class="font-light text-gray-400">PROJECT</span></h1>
        <div class="w-12 h-1 bg-black mx-auto mt-4"></div>
      </div>

      <div class="space-y-6 max-w-xs mx-auto">
        <input id="username" type="text" placeholder="Ä°sminizi Giriniz" class="elite-input w-full py-5 rounded-2xl text-lg shadow-sm">
        
        <button onclick="joinGame()" class="elite-btn w-full py-5 rounded-2xl text-sm uppercase shadow-elite">
          YarÄ±ÅŸmaya KatÄ±l
        </button>
        
        <!-- YÃ–NETÄ°CÄ° BUTONU (Otomatik Gizlenir) -->
        <div id="admin-login-area" class="pt-10 transition-all duration-500 opacity-100">
          <button onclick="joinAdmin()" class="text-[10px] font-bold text-gray-400 hover:text-black transition uppercase tracking-[0.2em] border-b border-transparent hover:border-black pb-1">
            YÃ¶netici GiriÅŸi
          </button>
        </div>
      </div>
    </div>

    <!-- 2. BEKLEME -->
    <div id="screen-wait" class="hidden text-center fade-in">
      <div class="w-20 h-20 bg-black text-white rounded-full flex items-center justify-center mx-auto mb-8 shadow-elite animate-pulse">
        <span id="player-count" class="text-2xl font-bold">0</span>
      </div>
      <h2 class="text-3xl font-bold tracking-tight mb-3">Bekleniyor...</h2>
      <p class="text-gray-500 font-medium">YÃ¶netici oyunu baÅŸlattÄ±ÄŸÄ±nda ekran deÄŸiÅŸecektir.</p>
    </div>

    <!-- 3. ADMIN PANELÄ° -->
    <div id="screen-admin" class="hidden w-full h-[85vh] flex flex-col fade-in bg-white border border-gray-100 rounded-3xl shadow-2xl overflow-hidden">
      <div class="p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50/30">
        <div>
          <h2 class="text-xl font-bold text-black tracking-tight">YÃ¶netici Paneli</h2>
          <div class="flex items-center gap-2 mt-1">
            <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
            <span class="text-xs text-gray-500 font-medium uppercase tracking-wide">CanlÄ± BaÄŸlantÄ±</span>
          </div>
        </div>
        <button id="start-btn" onclick="startGame()" class="bg-black text-white px-8 py-3 rounded-xl text-sm font-bold hover:bg-gray-800 transition shadow-lg transform active:scale-95">
          BAÅžLAT
        </button>
      </div>

      <div class="flex-1 overflow-y-auto p-2" id="admin-list"></div>
    </div>

    <!-- 4. OYUN EKRANI -->
    <div id="screen-game" class="hidden w-full fade-in">
      <div class="flex justify-between items-center mb-10 px-1">
        <span id="q-counter" class="text-xs font-black text-gray-300 tracking-[0.2em]">01 / 30</span>
        <div class="w-32 h-1 bg-gray-100 rounded-full overflow-hidden">
          <div id="progress-bar" class="h-full bg-black transition-all duration-500" style="width: 0%"></div>
        </div>
      </div>

      <div id="question-text" class="text-xl md:text-2xl font-bold leading-relaxed mb-10 text-center text-black min-h-[120px] flex items-center justify-center">
        YÃ¼kleniyor...
      </div>

      <div id="options-area" class="grid grid-cols-1 gap-3 max-w-md mx-auto"></div>
    </div>

    <!-- 5. ELENME -->
    <div id="screen-eliminated" class="hidden text-center fade-in">
      <div class="w-24 h-24 bg-red-50 text-red-500 rounded-full flex items-center justify-center mx-auto mb-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
      </div>
      <h1 class="text-3xl font-bold text-black mb-3">Elendiniz</h1>
      <p class="text-gray-500">LÃ¼tfen oyunun bitmesini bekleyin.<br>SÄ±ralama sonunda gÃ¶sterilecektir.</p>
    </div>

    <!-- 6. SONUÃ‡ -->
    <div id="screen-result" class="hidden w-full h-[90vh] flex flex-col fade-in bg-white border border-gray-200 rounded-3xl shadow-2xl overflow-hidden">
      <div class="p-8 text-center bg-gray-50 border-b border-gray-200">
        <h2 id="winner-title" class="text-4xl font-black mb-2 uppercase tracking-tighter text-black"></h2>
        <p id="winner-msg" class="text-gray-500 text-sm font-medium tracking-wide"></p>
      </div>
      <div class="px-6 py-3 text-[10px] font-bold text-gray-400 uppercase tracking-widest bg-white border-b border-gray-100">
        SÄ±ralama Tablosu
      </div>
      <div class="flex-1 overflow-y-auto bg-white" id="leaderboard-list"></div>
      <div class="p-4 border-t border-gray-100 bg-white">
        <button onclick="location.reload()" class="w-full bg-black text-white py-4 rounded-2xl font-bold text-sm hover:bg-gray-900 transition">
          YENÄ° OYUN
        </button>
      </div>
    </div>

  </div>

<script>
  const socket = io();
  let myRole = "player";
  let totalQuestions = 30; 

  // --- SORULAR ---
  const questions = [
    { q: "DoÄŸum sonrasÄ± emziren kadÄ±nlarda, Ã¶strojen nedeniyle Ã¶nerilmeyen yÃ¶ntem hangisidir?", options: ["Sadece progesteron iÃ§eren implant", "DMPA", "Kondom", "Kombine oral kontraseptifler", "BakÄ±rlÄ± RÄ°A"] },
    { q: "Emziren kadÄ±nlarda sadece progesteron iÃ§eren yÃ¶ntemlere doÄŸumdan ne zaman baÅŸlanabilir?", options: ["Hemen", "2 hafta sonra", "6 hafta sonra", "3 ay sonra", "6 ay sonra"] },
    { q: "DoÄŸum sonrasÄ± emzirmeyen kadÄ±nlar aile planlamasÄ± yÃ¶ntemine ne zaman baÅŸlayabilir?", options: ["DoÄŸumdan 2 ay sonra", "DoÄŸumdan hemen veya 3 hafta sonra", "DoÄŸumdan 6 ay sonra", "Sadece adet sonrasÄ±", "Sadece 40. gÃ¼nden sonra"] },
    { q: "DoÄŸum sonrasÄ± kondom kullanÄ±mÄ±nÄ±n en Ã¶nemli nedeni nedir?", options: ["SÃ¼tÃ¼ artÄ±rmasÄ±", "Yan etkilerinin olmamasÄ±", "Uzun etkili yÃ¶nteme geÃ§inceye kadar koruma saÄŸlamasÄ±", "Rahim kasÄ±lmalarÄ±nÄ± azaltmasÄ±", "Ekonomik olmasÄ±"] },
    { q: "DoÄŸum sonrasÄ± diyafram ve servikal baÅŸlÄ±k kullanÄ±mÄ± iÃ§in kaÃ§ hafta beklenmelidir?", options: ["2 hafta", "3 hafta", "4 hafta", "6 hafta", "8 hafta"] },
    { q: "Komplikasyonsuz isteyerek dÃ¼ÅŸÃ¼k sonrasÄ± aÅŸaÄŸÄ±daki yÃ¶ntemlerden hangisine hemen baÅŸlanabilir?", options: ["DoÄŸal yÃ¶ntemler", "KOK", "DoÄŸurganlÄ±k takibi", "Servikal baÅŸlÄ±k", "Annelik planlama testi"] },
    { q: "DÃ¼ÅŸÃ¼k sonrasÄ± baÅŸlanmamasÄ± gereken yÃ¶ntem hangisidir?", options: ["Kondom", "RÄ°A", "Ä°mplant", "DoÄŸal aile planlamasÄ± yÃ¶ntemleri", "DMPA"] },
    { q: "GenÃ§lerin yÃ¶ntem kullanÄ±rken yaÅŸadÄ±ÄŸÄ± en bÃ¼yÃ¼k sorunlardan biri nedir?", options: ["YÃ¶ntemlerin Ã§ok pahalÄ± olmasÄ±", "Aile ve arkadaÅŸlarÄ±nÄ±n fark etmesinden endiÅŸe duymalarÄ±", "SaÄŸlÄ±k Ã§alÄ±ÅŸanÄ±na gÃ¼venmemeleri", "SaÄŸlÄ±k kuruluÅŸuna gidememeleri", "Ovulasyon takibini bilmemeleri"] },
    { q: "GenÃ§lerde 18 yaÅŸ altÄ±nda ilk seÃ§enek olmayan yÃ¶ntem aÅŸaÄŸÄ±dakilerden hangisidir?", options: ["Kondom", "Diyafram", "Spermisit", "Sadece progesteron iÃ§eren enjekte edilen yÃ¶ntemler", "KOK"] },
    { q: "20 yaÅŸ altÄ±ndaki nulliparlarda ilk seÃ§enek olmayan yÃ¶ntem hangisidir?", options: ["Kondom", "KOK", "DMPA", "Cu-RÄ°A", "Mini hap"] },
    { q: "GenÃ§lerde CYBE riskine karÅŸÄ± en etkili koruma hangi kombinasyonda saÄŸlanÄ±r?", options: ["KOK tek baÅŸÄ±na", "Diyafram + spermisit", "Kondom + KOK", "RÄ°A + KOK", "Ä°mplant + KOK"] },
    { q: "GenÃ§lerde sigara kullanÄ±mÄ±na baÄŸlÄ± olarak hangi KOK tÃ¼rÃ¼ Ã¶nerilir?", options: ["50 Âµg Ã¶strojen iÃ§eren", "35 Âµg Ã¶strojen iÃ§eren", "20 Âµg etinil Ã¶stradiol iÃ§eren", "Sadece Ã¶strojen iÃ§eren", "Ã–strojen iÃ§ermeyen"] },
    { q: "Menopoz dÃ¶neminde gebelik riskinin devam etmesinin nedeni nedir?", options: ["KadÄ±nÄ±n sÃ¼t Ã¼retmesi", "Rahmin bÃ¼yÃ¼mesi", "DÃ¼zensiz ovulasyon nedeniyle yumurtlamanÄ±n devam edebilmesi", "FolikÃ¼llerin artmasÄ±", "Endometriumun incelmesi"] },
    { q: "AÅŸaÄŸÄ±dakilerden hangisi menopoz yaÅŸÄ± iÃ§in doÄŸrudur?", options: ["TÃ¼rkiyeâ€™de ortalama 35", "DÃ¼nya genelinde 40", "TÃ¼rkiyeâ€™de ortalama 50", "55â€“60 arasÄ± deÄŸiÅŸir", "Sigara iÃ§mek menopoz yaÅŸÄ±nÄ± yÃ¼kseltir"] },
    { q: "Acil kontrasepsiyon ile ilgili yanlÄ±ÅŸ olan ifade hangisidir?", options: ["GebeliÄŸi bÃ¼yÃ¼k Ã¶lÃ§Ã¼de Ã¶nler", "%99 etkilidir", "RÄ°A kullanÄ±labilir", "Gebelik oluÅŸtuktan sonra etkilidir", "TecavÃ¼z durumunda Ã¶zenli danÄ±ÅŸmanlÄ±k gerekir"] },
    { q: "Acil kontrasepsiyonun tek kontrendikasyonu nedir?", options: ["Emzirme", "GenÃ§ yaÅŸ", "Sadece progesteron kullanÄ±mÄ±", "Gebelik", "DoÄŸumsal uterin anomaliler"] },
    { q: "Acil kontrasepsiyonda RÄ°A'nÄ±n etkisi nedir?", options: ["Endometrium kalÄ±nlaÅŸtÄ±rÄ±r", "Fertilizasyonu ve implantasyonu Ã¶nler", "Ovulasyonu durdurur", "Serviks mukusunu inceltir", "Progesteronu artÄ±rÄ±r"] },
    { q: "GenÃ§lerin cinselliÄŸi Ã§oÄŸu zaman hangi ihtiyaca dayanÄ±r?", options: ["Anne olma isteÄŸi", "Fiziksel zorunluluk", "Kabul edilme veya ÅŸefkat ihtiyacÄ±", "Aile baskÄ±sÄ±ndan kaÃ§Ä±nma", "Sosyal medya etkisi"] },
    { q: "Zeka engelli kiÅŸiler iÃ§in aile planlamasÄ± hizmetlerinde Ã¶ncelik hangisidir?", options: ["YÃ¶ntemi gizlemek", "DanÄ±ÅŸmanlÄ±ÄŸÄ±n onlarÄ±n anlayacaÄŸÄ± ÅŸekilde verilmesi", "YÃ¼ksek doz hormon tercih etmek", "Sadece kondom vermek", "KalÄ±cÄ± yÃ¶ntem zorunluluÄŸu"] },
    { q: "DoÄŸum sonrasÄ± kombine enjekte edilen kontraseptifler en erken ne zaman baÅŸlanabilir?", options: ["DoÄŸumdan hemen", "1 hafta sonra", "2 hafta sonra", "3 hafta sonra", "3 ay sonra"] },
    { q: "DÃ¼ÅŸÃ¼k sonrasÄ± kadÄ±nlara aile planlamasÄ± danÄ±ÅŸmanlÄ±ÄŸÄ± ne zaman verilmelidir?", options: ["Sadece taburcu olurken", "Adet olunca", "DÃ¼ÅŸÃ¼kten Ã¶nce, hemen sonra veya kontrolde", "6 hafta sonra", "YÃ¶ntem istediÄŸinde"] },
    { q: "Acil kontrasepsiyon aÅŸaÄŸÄ±dakilerden hangisidir?", options: ["DÃ¼zenli bir aile planlamasÄ± yÃ¶ntemi", "Ä°stenmeyen gebeliÄŸi Ã¶nlemek iÃ§in kullanÄ±lan geÃ§ici yÃ¶ntem", "KalÄ±cÄ± Ã§Ã¶zÃ¼m", "Sadece genÃ§lere Ã¶nerilen yÃ¶ntem", "Aile planlamasÄ± dÄ±ÅŸÄ± bir uygulama"] },
    { q: "Acil kontrasepsiyonda etkililik neden zamanla azalÄ±r?", options: ["Rahim kÃ¼Ã§Ã¼lÃ¼r", "Fertilizasyon ve implantasyon zamanla gerÃ§ekleÅŸebilir", "Ovulasyon durur", "Hormonlar artar", "Servikste kuruluk olur"] },
    { q: "AÅŸaÄŸÄ±dakilerden hangisi genÃ§lerde yÃ¶ntem seÃ§iminde Ã¶nemli bir zorluktur?", options: ["SaÄŸlÄ±k Ã§alÄ±ÅŸanÄ±na ulaÅŸamamak", "DÃ¼zenli uygulama gerektiren yÃ¶ntemlerden kaÃ§Ä±nmalarÄ±", "Aile onayÄ±nÄ±n zorunlu olmasÄ±", "YÃ¶ntem fiyatlarÄ±nÄ±n yÃ¼ksek olmasÄ±", "Ä°Ã§ salgÄ± bozukluÄŸu"] },
    { q: "Perimenopozdaki bir kadÄ±nda gebelik neden risklidir?", options: ["Serviks Ã§ok dar olduÄŸu iÃ§in", "Kan deÄŸerleri dÃ¼ÅŸÃ¼k olduÄŸu iÃ§in", "Anne ve bebek iÃ§in komplikasyon riski arttÄ±ÄŸÄ± iÃ§in", "DoÄŸum kanamasÄ± olmadÄ±ÄŸÄ± iÃ§in", "FSH dÃ¼ÅŸÃ¼k olduÄŸu iÃ§in"] },
    { q: "GenÃ§lerde istenmeyen cinsel davranÄ±ÅŸlarÄ±n bir nedeni nedir?", options: ["Erken menopoz", "Vitamin eksikliÄŸi", "Zorla veya baskÄ± ile iliÅŸkiye maruz kalma", "Ovulasyon bozukluÄŸu", "Uygun partner bulamama"] },
    { q: "AÅŸaÄŸÄ±dakilerden hangisi aile planlamasÄ± yÃ¶ntemlerinin genÃ§lerde kullanÄ±labilirliÄŸi hakkÄ±nda doÄŸrudur?", options: ["Ã‡oÄŸu yÃ¶ntemi kullanamazlar", "RÄ°A genÃ§lerde yasaktÄ±r", "Mevcut tÃ¼m yÃ¶ntemler kullanÄ±labilir, ancak bazÄ±larÄ± ilk seÃ§enek deÄŸildir", "Sadece kondom uygundur", "Sadece hormonal yÃ¶ntem uygundur"] },
    { q: "Eczanelerin aile planlamasÄ± hizmetlerinde avantajlarÄ±ndan biri deÄŸildir?", options: ["YakÄ±n ve hÄ±zlÄ± hizmet", "FarklÄ± marka seÃ§enekleri", "TanÄ±dÄ±k olmayan ortam", "KalÄ±cÄ± yÃ¶ntem yapabilmesi", "Ãœcretsiz bilgi ve Ã¶neri verilmesi"] },
    { q: "Acil kontrasepsiyonun yaygÄ±n kullanÄ±mÄ± neyi saÄŸlar?", options: ["SÃ¼t Ã¼retimini artÄ±rÄ±r", "Ovulasyonu dÃ¼zenler", "Milyonlarca istenmeyen gebeliÄŸin oluÅŸmadan Ã¶nlenmesi", "Regl dÃ¼zenini dÃ¼zeltir", "RÄ°A kullanÄ±mÄ±nÄ± azaltÄ±r"] },
    { q: "Eczanelerin aile planlamasÄ±nda rolÃ¼ ile ilgili doÄŸru ifade hangisidir?", options: ["GebeliÄŸi Ã¶nleyici yÃ¶ntemler sadece doktor tarafÄ±ndan verilebilir", "Eczanelerde hekime gitmeden gebelikten korunma Ã¼rÃ¼nleri alÄ±nabilir", "Eczaneler sadece KOK satar", "DanÄ±ÅŸmanlÄ±k Ã¼cretlidir", "GenÃ§lere hizmet vermezler"] }
  ];

  // --- LOGIC ---

  socket.on("adminStatus", (data) => {
    const adminArea = document.getElementById("admin-login-area");
    if (data.hasAdmin) adminArea.classList.add("hidden");
    else adminArea.classList.remove("hidden");
  });

  function joinGame() {
    const name = document.getElementById("username").value;
    if(!name) return;
    myRole = "player";
    socket.emit("joinGame", name);
    showScreen("screen-wait");
  }

  function joinAdmin() {
    myRole = "admin";
    socket.emit("joinAsAdmin");
    showScreen("screen-admin");
  }

  function startGame() {
    socket.emit("startGame");
    const btn = document.getElementById("start-btn");
    btn.innerText = "YAYINDA";
    btn.classList.remove("bg-black");
    btn.classList.add("bg-green-500", "cursor-default");
    btn.disabled = true;
  }

  socket.on("adminData", (data) => {
    if(myRole !== "admin") return;
    totalQuestions = data.totalQuestions;
    const list = document.getElementById("admin-list");
    list.innerHTML = "";
    const sortedPlayers = data.players.sort((a,b) => b.currentQuestionIndex - a.currentQuestionIndex);

    sortedPlayers.forEach((p, index) => {
      let statusBadge = `<span class="px-2 py-1 rounded text-[10px] font-bold uppercase bg-green-100 text-green-700">Aktif</span>`;
      if(p.eliminated) statusBadge = `<span class="px-2 py-1 rounded text-[10px] font-bold uppercase bg-red-50 text-red-500">Elendi</span>`;
      else if(p.finished) statusBadge = `<span class="px-2 py-1 rounded text-[10px] font-bold uppercase bg-yellow-100 text-yellow-700">Bitti</span>`;

      const item = document.createElement("div");
      item.className = "flex items-center justify-between p-4 mb-2 bg-gray-50 rounded-2xl border border-transparent hover:border-gray-200 transition";
      item.innerHTML = `
        <div class="flex items-center gap-4">
          <span class="text-xs font-bold text-gray-300 w-4">#${index+1}</span>
          <span class="font-bold text-sm text-black">${p.name}</span>
        </div>
        <div class="flex items-center gap-3">
          ${statusBadge}
          <span class="text-xs font-mono font-bold text-gray-400 w-10 text-right">${p.currentQuestionIndex}/${totalQuestions}</span>
        </div>
      `;
      list.appendChild(item);
    });
  });

  socket.on("playerCountUpdate", (c) => document.getElementById("player-count").innerText = c);
  
  socket.on("gameStarted", () => {
    if(myRole === "player") {
      showScreen("screen-game");
      loadQuestion(0); // <--- Ä°ÅžTE BU EKLENDÄ°! ARTIK YÃœKLENÄ°YORDA KALMAZ!
    }
  });

  socket.on("nextQuestion", (idx) => loadQuestion(idx));

  function loadQuestion(index) {
    if(index >= questions.length) return;
    
    // Progress
    const percent = ((index) / questions.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
    document.getElementById("q-counter").innerText = (index + 1).toString().padStart(2, '0') + " / " + questions.length;

    const qText = document.getElementById("question-text");
    qText.style.opacity = 0;
    setTimeout(() => {
      qText.innerText = questions[index].q;
      qText.style.opacity = 1;
    }, 200);

    const area = document.getElementById("options-area");
    area.innerHTML = "";

    questions[index].options.forEach((opt, i) => {
      const btn = document.createElement("button");
      btn.className = "w-full text-left p-5 rounded-2xl border border-gray-100 bg-white hover:border-black hover:shadow-lg transition-all duration-300 text-sm font-semibold text-gray-700 active:scale-[0.98] shadow-sm";
      btn.innerText = opt;
      btn.onclick = () => {
        socket.emit("submitAnswer", i);
        area.style.pointerEvents = "none";
        btn.classList.add("bg-black", "text-white", "border-black");
        btn.classList.remove("bg-white", "text-gray-700");
      };
      area.appendChild(btn);
    });
    area.style.pointerEvents = "auto";
  }

  socket.on("youAreEliminated", () => {
    showScreen("screen-eliminated");
  });

  socket.on("playerFinishedLate", () => {
    showScreen("screen-eliminated");
    document.querySelector("#screen-eliminated h1").innerText = "TamamlandÄ±";
    document.querySelector("#screen-eliminated p").innerHTML = "SÄ±ralama hesaplanÄ±yor...<br>LÃ¼tfen bekleyin.";
  });

  socket.on("gameOver", (data) => {
    if(myRole === "admin") {
      document.getElementById("start-btn").innerText = "TAMAMLANDI";
      document.getElementById("start-btn").classList.add("bg-red-500");
      document.getElementById("start-btn").classList.remove("bg-green-500");
      return;
    }

    showScreen("screen-result");
    const list = document.getElementById("leaderboard-list");
    list.innerHTML = "";

    if(data.noWinner) {
      document.getElementById("winner-title").innerText = "OYUN BÄ°TTÄ°";
      document.getElementById("winner-msg").innerText = "Kazanan Ã§Ä±kmadÄ±, herkes elendi.";
    } else {
      document.getElementById("winner-title").innerText = "KAZANAN: " + data.winnerName;
      document.getElementById("winner-msg").innerText = "Åžampiyon belli oldu!";
      if (document.getElementById("username").value === data.winnerName) {
        confetti({ particleCount: 300, spread: 100, origin: { y: 0.6 }, colors: ['#000000', '#aaaaaa'] });
      }
    }

    data.leaderboard.forEach((p, index) => {
      let icon = `<span class="text-gray-300 font-bold w-6 text-center text-xs">#${index+1}</span>`;
      let rowClass = "bg-white";
      let nameClass = "text-black";
      let scoreClass = "text-gray-400";
      
      if (index === 0) icon = "ðŸ¥‡";
      if (index === 1) icon = "ðŸ¥ˆ";
      if (index === 2) icon = "ðŸ¥‰";

      if (p.name === document.getElementById("username").value) {
        rowClass = "bg-gray-50 border-l-4 border-black";
        nameClass = "font-black";
        scoreClass = "text-black font-bold";
      }

      const row = document.createElement("div");
      row.className = `flex items-center justify-between px-6 py-4 border-b border-gray-50 ${rowClass}`;
      row.innerHTML = `
        <div class="flex items-center gap-4">
          <div class="text-lg w-8 text-center">${icon}</div>
          <div class="text-sm ${nameClass}">${p.name}</div>
        </div>
        <div class="text-xs font-mono ${scoreClass}">
          ${p.score} PUAN
        </div>
      `;
      list.appendChild(row);
    });
  });

  function showScreen(id) {
    document.querySelectorAll(".max-w-xl > div").forEach(div => div.classList.add("hidden"));
    const target = document.getElementById(id);
    target.classList.remove("hidden");
    target.classList.add("fade-in");
  }
</script>
</body>
</html>


